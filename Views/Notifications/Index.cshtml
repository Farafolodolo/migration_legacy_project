@model List<TaskManagerMVC.Models.Notification>
@{
    ViewData["Title"] = "Notificaciones";
}

<h4>Notificaciones</h4>

<div class="mb-3">
    @if (ViewBag.UnreadCount > 0)
    {
        <form asp-action="MarkAllAsRead" method="post" class="d-inline">
            <button type="submit" class="btn btn-secondary">Marcar todas como le√≠das (@ViewBag.UnreadCount sin leer)</button>
        </form>
    }
    else
    {
        <span class="text-muted">No hay notificaciones sin leer</span>
    }
</div>

@if (Model.Any())
{
    @foreach (var notification in Model)
    {
        <div class="card mb-2 @(notification.IsRead ? "" : "border-primary")">
            <div class="card-body">
                <p class="mb-1">
                    @if (!notification.IsRead)
                    {
                        <span class="badge bg-primary me-2">Nueva</span>
                    }
                    @notification.Message
                </p>
                <small class="text-muted">@notification.CreatedAt.ToString("yyyy-MM-dd HH:mm")</small>
                @if (notification.TaskItem != null)
                {
                    <br /><small class="text-muted">Tarea: @notification.TaskItem.Title</small>
                }
            </div>
        </div>
    }
}
else
{
    <div class="alert alert-info">No hay notificaciones.</div>
}
